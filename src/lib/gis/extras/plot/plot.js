//>>built
require({cache:{"plot/geometry/Polyline":function(){define(["dojo/_base/declare","../plotUtils","./PlotGeometry"],function(h,e,b){return h([b],{constructor:function(b,a){this.plotType=this.type="polyline";this.setPoints(b)},generate:function(){2>this.getPointCount()||(this.paths=this.points)}})})},"plot/geometry/Arc":function(){define(["dojo/_base/declare","../plotUtils","./PlotGeometry"],function(h,e,b){return h([b],{constructor:function(b,a){this.type="polyline";this.plotType="arc";this.fixPointCount=
3;this.setPoints(b)},generate:function(){var b=this.getPointCount();if(!(2>b))if(2==b)this.paths=this.points;else{var a=this.points[0],d=this.points[1],k=this.points[2],b=e.getCircleCenterOfThreePoints(a,d,k),f=e.distance(a,b),g=e.getAzimuth(a,b),l=e.getAzimuth(d,b);e.isClockWise(a,d,k)?a=l:(a=g,g=l);this.paths=e.getArcPoints(b,f,a,g)}}})})},"plot/geometry/Curve":function(){define(["dojo/_base/declare","../plotUtils","./PlotGeometry"],function(h,e,b){return h([b],{constructor:function(b,a){this.type=
"polyline";this.plotType="curve";this.t=0.3;this.setPoints(b)},generate:function(){var b=this.getPointCount();2>b||(this.paths=2==b?this.points:e.getCurvePoints(this.t,this.points))}})})},"plot/geometry/ClosedCurve":function(){define(["dojo/_base/declare","../constants","../plotUtils","./PlotGeometry"],function(h,e,b,c){return h([c],{constructor:function(a,d){this.type="polygon";this.plotType="closedcurve";this.t=0.3;this.setPoints(a)},generate:function(){var a=this.getPointCount();if(!(2>a))if(2==
a)this.rings=this.points;else{var d=this.getPoints();d.push(d[0],d[1]);for(var c=[],a=0;a<d.length-2;a++)var f=b.getBisectorNormals(this.t,d[a],d[a+1],d[a+2]),c=c.concat(f);a=c.length;c=[c[a-1]].concat(c.slice(0,a-1));f=[];for(a=0;a<d.length-2;a++){var g=d[a],l=d[a+1];f.push(g);for(var m=0;m<=e.FITTING_COUNT;m++){var h=b.getCubicValue(m/e.FITTING_COUNT,g,c[2*a],c[2*a+1],l);f.push(h)}f.push(l)}this.rings=f}}})})},"plot/geometry/FreehandPolygon":function(){define(["dojo/_base/declare","../plotUtils",
"./PlotGeometry"],function(h,e,b){return h([b],{constructor:function(b,a){this.type="polygon";this.plotType="freehandpolygon";this.freehand=!0;this.setPoints(b)},generate:function(){2>this.getPointCount()||(this.rings=this.points.concat([this.points[0]]))}})})},"plot/geometry/Circle":function(){define(["dojo/_base/declare","../constants","../plotUtils","./PlotGeometry"],function(h,e,b,c){return h([c],{constructor:function(a,d){this.type="polygon";this.plotType="circle";this.fixPointCount=2;this.setPoints(a)},
generate:function(){if(!(2>this.getPointCount())){var a=this.points[0],d=b.distance(a,this.points[1]);this.rings=this.generatePoints(a,d)}},generatePoints:function(a,d){for(var b,c,g=[],l=0;l<=e.FITTING_COUNT;l++)c=2*Math.PI*l/e.FITTING_COUNT,b=a[0]+d*Math.cos(c),c=a[1]+d*Math.sin(c),g.push([b,c]);return g}})})},"plot/geometry/Sector":function(){define(["dojo/_base/declare","../plotUtils","./PlotGeometry"],function(h,e,b){return h([b],{constructor:function(b,a){this.type="polygon";this.plotType="sector";
this.fixPointCount=3;this.setPoints(b)},generate:function(){if(!(2>this.getPointCount()))if(2==this.getPointCount())this.rings=this.points;else{var b=this.getPoints(),a=b[0],d=b[1],k=b[2],b=e.distance(d,a),d=e.getAzimuth(d,a),k=e.getAzimuth(k,a),b=e.getArcPoints(a,b,d,k);b.push(a,b[0]);this.rings=b}}})})},"plot/geometry/StraightArrow":function(){define(["dojo/_base/declare","../plotUtils","./PlotGeometry"],function(h,e,b){return h([b],{constructor:function(b,a){this.type="polyline";this.plotType=
"straightarrow";this.fixPointCount=2;this.maxArrowLength=3E6;this.arrowLengthScale=5;this.setPoints(b)},generate:function(){if(!(2>this.getPointCount())){var b=this.getPoints(),a=b[0],b=b[1],d=e.distance(a,b)/this.arrowLengthScale,d=d>this.maxArrowLength?this.maxArrowLength:d,k=e.getThirdPoint(a,b,Math.PI/6,d,!1),d=e.getThirdPoint(a,b,Math.PI/6,d,!0);this.paths=[a,b,k,b,d]}}})})},"plot/plotEncoder":function(){define([],function(){return{toJson:function(h){if(h&&h.plot&&h.symbol)return{plot:h.plot.toJson(),
symbol:h.symbol.toJson()}}}})},"plot/geometry/TailedAttackArrow":function(){define(["dojo/_base/declare","../plotUtils","./AttackArrow"],function(h,e,b){return h([b],{constructor:function(b,a){this.type="polygon";this.plotType="tailedattackarrow";this.headHeightFactor=0.18;this.headWidthFactor=0.3;this.neckHeightFactor=0.85;this.neckWidthFactor=0.15;this.tailWidthFactor=0.1;this.headTailFactor=0.8;this.swallowTailFactor=1;this.swallowTailPnt=null;this.setPoints(b)},generate:function(){var b=this.getPointCount();
if(!(2>b))if(2==this.getPointCount())this.rings=this.points;else{var a=this.getPoints(),d=a[0],k=a[1];e.isClockWise(a[0],a[1],a[2])&&(d=a[1],k=a[0]);var b=[e.mid(d,k)].concat(a.slice(2)),a=this.getArrowHeadPoints(b,d,k),f=a[0],g=a[4],l=e.distance(d,k),m=e.getBaseLength(b);this.swallowTailPnt=e.getThirdPoint(b[1],b[0],0,m*this.tailWidthFactor*this.swallowTailFactor,!0);l=this.getArrowBodyPoints(b,f,g,l/m);b=l.length;d=[d].concat(l.slice(0,b/2));d.push(f);k=[k].concat(l.slice(b/2,b));k.push(g);d=e.getQBSplinePoints(d);
k=e.getQBSplinePoints(k);this.rings=d.concat(a,k.reverse(),[this.swallowTailPnt,d[0]])}}})})},"plot/geometry/GatheringPlace":function(){define(["dojo/_base/declare","../constants","../plotUtils","./PlotGeometry"],function(h,e,b,c){return h([c],{constructor:function(a,b){this.type="polygon";this.plotType="gatheringplace";this.t=0.4;this.fixPointCount=3;this.setPoints(a)},generate:function(){var a=this.getPoints();if(!(2>a.length)){if(2==this.getPointCount())var d=b.mid(a[0],a[1]),c=b.distance(a[0],
d)/0.9,f=b.getThirdPoint(a[0],d,e.HALF_PI,c,!0),a=[a[0],f,a[1]];d=b.mid(a[0],a[2]);a.push(d,a[0],a[1]);d=[];for(c=0;c<a.length-2;c++)var g=a[c],l=a[c+1],f=b.getBisectorNormals(this.t,g,l,a[c+2]),d=d.concat(f);for(var c=d.length,d=[d[c-1]].concat(d.slice(0,c-1)),m=[],c=0;c<a.length-2;c++){g=a[c];l=a[c+1];m.push(g);for(var h=0;h<=e.FITTING_COUNT;h++)f=b.getCubicValue(h/e.FITTING_COUNT,g,d[2*c],d[2*c+1],l),m.push(f);m.push(l)}this.rings=m}}})})},"plot/geometry/Lune":function(){define(["dojo/_base/declare",
"../constants","../plotUtils","./PlotGeometry"],function(h,e,b,c){return h([c],{constructor:function(a,b){this.type="polygon";this.plotType="lune";this.fixPointCount=3;this.setPoints(a)},generate:function(){if(!(2>this.getPointCount())){var a=this.getPoints();if(2==this.getPointCount()){var d=b.mid(a[0],a[1]),c=b.distance(a[0],d),d=b.getThirdPoint(a[0],d,e.HALF_PI,c);a.push(d)}var c=a[0],f=a[1],g=a[2],a=b.getCircleCenterOfThreePoints(c,f,g),d=b.distance(c,a),l=b.getAzimuth(c,a),m=b.getAzimuth(f,a);
b.isClockWise(c,f,g)?(c=m,f=l):(c=l,f=m);a=b.getArcPoints(a,d,c,f);a.push(a[0]);this.rings=a}}})})},"plot/geometry/DoubleArrow":function(){define(["dojo/_base/declare","../constants","../plotUtils","./PlotGeometry"],function(h,e,b,c){return h([c],{constructor:function(a,b){this.type="polygon";this.plotType="doublearrow";this.headHeightFactor=0.25;this.headWidthFactor=0.3;this.neckHeightFactor=0.85;this.neckWidthFactor=0.15;this.tempPoint4=this.connPoint=null;this.fixPointCount=4;this.setPoints(a)},
generate:function(){var a=this.getPointCount();if(!(2>a))if(2==a)this.rings=this.points;else{var d=this.points[0],c=this.points[1],f=this.points[2],a=this.getPointCount();this.tempPoint4=3==a?this.getTempPoint4(d,c,f):this.points[3];this.connPoint=3==a||4==a?b.mid(d,c):this.points[4];var g;b.isClockWise(d,c,f)?(a=this.getArrowPoints(d,this.connPoint,this.tempPoint4,!1),g=this.getArrowPoints(this.connPoint,c,f,!0)):(a=this.getArrowPoints(c,this.connPoint,f,!1),g=this.getArrowPoints(this.connPoint,
d,this.tempPoint4,!0));var e=a.length,m=(e-5)/2,c=a.slice(0,m),d=a.slice(m,m+5),a=a.slice(m+5,e),f=g.slice(0,m),h=g.slice(m,m+5);g=g.slice(m+5,e);f=b.getBezierPoints(f);c=b.getBezierPoints(g.concat(c.slice(1)));a=b.getBezierPoints(a);d=f.concat(h,c,d,a);this.rings=d.concat([d[0]])}},finishDrawing:function(){3==this.getPointCount()&&null!=this.tempPoint4&&this.points.push(this.tempPoint4);null!=this.connPoint&&this.points.push(this.connPoint)},getArrowPoints:function(a,d,c,f){var g=b.mid(a,d),l=b.distance(g,
c),m=b.getThirdPoint(c,g,0,0.3*l,!0),h=b.getThirdPoint(c,g,0,0.5*l,!0),m=b.getThirdPoint(g,m,e.HALF_PI,l/5,f),h=b.getThirdPoint(g,h,e.HALF_PI,l/4,f),l=[g,m,h,c];c=this.getArrowHeadPoints(l,this.headHeightFactor,this.headWidthFactor,this.neckHeightFactor,this.neckWidthFactor);f=c[0];g=c[4];m=b.distance(a,d)/b.getBaseLength(l)/2;m=this.getArrowBodyPoints(l,f,g,m);h=m.length;l=m.slice(0,h/2);m=m.slice(h/2,h);l.push(f);m.push(g);l=l.reverse();l.push(d);m=m.reverse();m.push(a);return l.reverse().concat(c,
m)},getArrowHeadPoints:function(a,d,c){var f=b.getBaseLength(a)*this.headHeightFactor,g=a[a.length-1];b.distance(d,c);c=f*this.headWidthFactor;d=f*this.neckWidthFactor;var l=f*this.neckHeightFactor,f=b.getThirdPoint(a[a.length-2],g,0,f,!0),l=b.getThirdPoint(a[a.length-2],g,0,l,!0);a=b.getThirdPoint(g,f,e.HALF_PI,c,!1);c=b.getThirdPoint(g,f,e.HALF_PI,c,!0);f=b.getThirdPoint(g,l,e.HALF_PI,d,!1);d=b.getThirdPoint(g,l,e.HALF_PI,d,!0);return[f,a,g,c,d]},getArrowBodyPoints:function(a,d,c,f){var g=b.wholeDistance(a);
f*=b.getBaseLength(a);d=b.distance(d,c);d=(f-d)/2;c=0;for(var e=[],h=[],n=1;n<a.length-1;n++){var q=b.getAngleOfThreePoints(a[n-1],a[n],a[n+1])/2;c+=b.distance(a[n-1],a[n]);var r=(f/2-c/g*d)/Math.sin(q),s=b.getThirdPoint(a[n-1],a[n],Math.PI-q,r,!0),q=b.getThirdPoint(a[n-1],a[n],q,r,!1);e.push(s);h.push(q)}return e.concat(h)},getTempPoint4:function(a,d,c){d=b.mid(a,d);var f=b.distance(d,c),g=b.getAngleOfThreePoints(a,d,c);g<e.HALF_PI?(c=f*Math.sin(g),f*=Math.cos(g),a=b.getThirdPoint(a,d,e.HALF_PI,
c,!1),a=b.getThirdPoint(d,a,e.HALF_PI,f,!0)):g>=e.HALF_PI&&g<Math.PI?(c=f*Math.sin(Math.PI-g),f*=Math.cos(Math.PI-g),a=b.getThirdPoint(a,d,e.HALF_PI,c,!1),a=b.getThirdPoint(d,a,e.HALF_PI,f,!1)):g>=Math.PI&&g<1.5*Math.PI?(c=f*Math.sin(g-Math.PI),f*=Math.cos(g-Math.PI),a=b.getThirdPoint(a,d,e.HALF_PI,c,!0),a=b.getThirdPoint(d,a,e.HALF_PI,f,!0)):(c=f*Math.sin(2*Math.PI-g),f*=Math.cos(2*Math.PI-g),a=b.getThirdPoint(a,d,e.HALF_PI,c,!0),a=b.getThirdPoint(d,a,e.HALF_PI,f,!1));return a}})})},"plot/constants":function(){define({TWO_PI:2*
Math.PI,HALF_PI:Math.PI/2,FITTING_COUNT:100,ZERO_TOLERANCE:1E-4})},"plot/geometry/FineArrow":function(){define(["dojo/_base/declare","../constants","../plotUtils","./PlotGeometry"],function(h,e,b,c){return h([c],{constructor:function(a,b){this.type="polygon";this.plotType="finearrow";this.tailWidthFactor=0.15;this.neckWidthFactor=0.2;this.headWidthFactor=0.25;this.headAngle=Math.PI/8.5;this.neckAngle=Math.PI/13;this.fixPointCount=2;this.setPoints(a)},generate:function(){if(!(2>this.getPointCount())){var a=
this.getPoints(),d=a[0],c=a[1],f=b.getBaseLength(a),g=f*this.tailWidthFactor,a=f*this.neckWidthFactor,l=f*this.headWidthFactor,f=b.getThirdPoint(c,d,e.HALF_PI,g,!0),g=b.getThirdPoint(c,d,e.HALF_PI,g,!1),h=b.getThirdPoint(d,c,this.headAngle,l,!1),l=b.getThirdPoint(d,c,this.headAngle,l,!0),n=b.getThirdPoint(d,c,this.neckAngle,a,!1),d=b.getThirdPoint(d,c,this.neckAngle,a,!0),c=[f,n,h,c,l,d,g];this.rings=c.concat([c[0]])}}})})},"plot/plotUtils":function(){define(["./constants"],function(h){var e={distance:function(b,
c){return Math.sqrt(Math.pow(b[0]-c[0],2)+Math.pow(b[1]-c[1],2))},wholeDistance:function(b){for(var c=0,a=0;a<b.length-1;a++)c+=e.distance(b[a],b[a+1]);return c},getBaseLength:function(b){return Math.pow(e.wholeDistance(b),0.99)},mid:function(b,c){return[(b[0]+c[0])/2,(b[1]+c[1])/2]},getCircleCenterOfThreePoints:function(b,c,a){var d=[(b[0]+c[0])/2,(b[1]+c[1])/2],k=[(b[0]+a[0])/2,(b[1]+a[1])/2];return e.getIntersectPoint(d,[d[0]-b[1]+c[1],d[1]+b[0]-c[0]],k,[k[0]-b[1]+a[1],k[1]+b[0]-a[0]])},getIntersectPoint:function(b,
c,a,d){if(b[1]==c[1])return d=(d[0]-a[0])/(d[1]-a[1]),c=d*(b[1]-a[1])+a[0],a=b[1],[c,a];if(a[1]==d[1])return c=(c[0]-b[0])/(c[1]-b[1]),c=c*(a[1]-b[1])+b[0],a=a[1],[c,a];c=(c[0]-b[0])/(c[1]-b[1]);d=(d[0]-a[0])/(d[1]-a[1]);a=(c*b[1]-b[0]-d*a[1]+a[0])/(c-d);c=c*a-c*b[1]+b[0];return[c,a]},getAzimuth:function(b,c){var a,d=Math.asin(Math.abs(c[1]-b[1])/e.distance(b,c));c[1]>=b[1]&&c[0]>=b[0]?a=d+Math.PI:c[1]>=b[1]&&c[0]<b[0]?a=h.TWO_PI-d:c[1]<b[1]&&c[0]<b[0]?a=d:c[1]<b[1]&&c[0]>=b[0]&&(a=Math.PI-d);return a},
getAngleOfThreePoints:function(b,c,a){b=e.getAzimuth(c,b)-e.getAzimuth(c,a);return 0>b?b+h.TWO_PI:b},isClockWise:function(b,c,a){return(a[1]-b[1])*(c[0]-b[0])>(c[1]-b[1])*(a[0]-b[0])},getPointOnLine:function(b,c,a){return[c[0]+b*(a[0]-c[0]),c[1]+b*(a[1]-c[1])]},getCubicValue:function(b,c,a,d,k){b=Math.max(Math.min(b,1),0);var f=1-b,g=b*b,e=g*b,h=f*f,n=h*f;return[n*c[0]+3*h*b*a[0]+3*f*g*d[0]+e*k[0],n*c[1]+3*h*b*a[1]+3*f*g*d[1]+e*k[1]]},getThirdPoint:function(b,c,a,d,k){b=e.getAzimuth(b,c);k=k?b+a:
b-a;a=d*Math.cos(k);d*=Math.sin(k);return[c[0]+a,c[1]+d]},getArcPoints:function(b,c,a,d){for(var k,f=[],g=d-a,g=0>g?g+h.TWO_PI:g,e=0;e<=h.FITTING_COUNT;e++)k=a+g*e/h.FITTING_COUNT,d=b[0]+c*Math.cos(k),k=b[1]+c*Math.sin(k),f.push([d,k]);return f},getBisectorNormals:function(b,c,a,d){var k=e.getNormal(c,a,d),f=Math.sqrt(k[0]*k[0]+k[1]*k[1]),g=k[0]/f,k=k[1]/f,l=e.distance(c,a),m=e.distance(a,d);f>h.ZERO_TOLERANCE?e.isClockWise(c,a,d)?(d=b*l,f=a[0]-d*k,l=a[1]+d*g,c=[f,l],d=b*m,f=a[0]+d*k,l=a[1]-d*g):
(d=b*l,f=a[0]+d*k,l=a[1]-d*g,c=[f,l],d=b*m,f=a[0]-d*k,l=a[1]+d*g):(f=a[0]+b*(c[0]-a[0]),l=a[1]+b*(c[1]-a[1]),c=[f,l],f=a[0]+b*(d[0]-a[0]),l=a[1]+b*(d[1]-a[1]));b=[f,l];return[c,b]},getNormal:function(b,c,a){var d=b[0]-c[0];b=b[1]-c[1];var k=Math.sqrt(d*d+b*b),d=d/k;b/=k;k=a[0]-c[0];c=a[1]-c[1];a=Math.sqrt(k*k+c*c);return[d+k/a,b+c/a]},getCurvePoints:function(b,c){for(var a=[e.getLeftMostControlPoint(c)],d=0;d<c.length-2;d++)var k=c[d],f=c[d+1],k=e.getBisectorNormals(b,k,f,c[d+2]),a=a.concat(k);d=
e.getRightMostControlPoint(c);a.push(d);for(var g=[],d=0;d<c.length-1;d++){k=c[d];f=c[d+1];g.push(k);for(b=0;b<h.FITTING_COUNT;b++){var l=e.getCubicValue(b/h.FITTING_COUNT,k,a[2*d],a[2*d+1],f);g.push(l)}g.push(f)}return g},getLeftMostControlPoint:function(b){var c=b[0],a=b[1],d=b[2];b=e.getBisectorNormals(0,c,a,d)[0];d=e.getNormal(c,a,d);if(Math.sqrt(d[0]*d[0]+d[1]*d[1])>h.ZERO_TOLERANCE){var d=e.mid(c,a),k=c[0]-d[0],f=c[1]-d[1],a=2/e.distance(c,a),c=-a*f,a=a*k,k=2*c*a,f=b[0]-d[0],g=b[1]-d[1];b=d[0]+
(c*c-a*a)*f+k*g;d=d[1]+k*f+(a*a-c*c)*g}else b=c[0]+t*(a[0]-c[0]),d=c[1]+t*(a[1]-c[1]);return[b,d]},getRightMostControlPoint:function(b){var c=b.length,a=b[c-3],d=b[c-2],c=b[c-1];b=e.getBisectorNormals(0,a,d,c)[1];a=e.getNormal(a,d,c);if(Math.sqrt(a[0]*a[0]+a[1]*a[1])>h.ZERO_TOLERANCE){var a=e.mid(d,c),k=c[0]-a[0],f=c[1]-a[1],c=2/e.distance(d,c),d=-c*f,c=c*k,k=2*d*c,f=b[0]-a[0],g=b[1]-a[1];b=a[0]+(d*d-c*c)*f+k*g;a=a[1]+k*f+(c*c-d*d)*g}else b=c[0]+t*(d[0]-c[0]),a=c[1]+t*(d[1]-c[1]);return[b,a]},getBezierPoints:function(b){if(2>=
b.length)return b;for(var c=[],a=b.length-1,d=0;1>=d;d+=0.01){for(var k=y=0,f=0;f<=a;f++){var g=e.getBinomialFactor(a,f),l=Math.pow(d,f),h=Math.pow(1-d,a-f),k=k+g*l*h*b[f][0];y+=g*l*h*b[f][1]}c.push([k,y])}c.push(b[a]);return c},getBinomialFactor:function(b,c){return e.getFactorial(b)/(e.getFactorial(c)*e.getFactorial(b-c))},getFactorial:function(b){if(1>=b)return 1;if(2==b)return 2;if(3==b)return 6;if(4==b)return 24;if(5==b)return 120;for(var c=1,a=1;a<=b;a++)c*=a;return c},getQBSplinePoints:function(b){if(2>=
b.length)return b;var c=[],a=b.length-2-1;c.push(b[0]);for(var d=0;d<=a;d++)for(var k=0;1>=k;k+=0.05){for(var f=y=0,g=0;2>=g;g++){var l=e.getQuadricBSplineFactor(g,k),f=f+l*b[d+g][0];y+=l*b[d+g][1]}c.push([f,y])}c.push(b[b.length-1]);return c},getQuadricBSplineFactor:function(b,c){return 0==b?Math.pow(c-1,2)/2:1==b?(-2*Math.pow(c,2)+2*c+1)/2:2==b?Math.pow(c,2)/2:0}};return e})},"plot/dijit/PlotToolbar":function(){define("dojo/Evented dojo/_base/declare dojo/_base/lang dojo/dnd/move dijit/_WidgetBase dijit/a11yclick dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/on dojo/text!./templates/PlotToolbar.html dojo/dom-class dojo/dom-style esri/dijit/ColorPicker".split(" "),
function(h,e,b,c,a,d,k,f,g,l,m,n,q){return e([a,k,f,h],{templateString:l,options:{baseClass:"PlotToolbar",visible:!0},widgetsInTemplate:!0,constructor:function(a,c){var d=b.mixin({},this.options,a);this.domNode=c;this.set("baseClass",d.baseClass);this.set("visible",d.visible);this.watch("baseClass",this._baseClassWatch);this.watch("visible",this._visibleWatch)},postCreate:function(){this.inherited(arguments);this.domNode&&new c.parentConstrainedMoveable(this.domNode,{within:!0});this.own(g(this.ulNode,
d,b.hitch(this,this._onClick)))},startup:function(){this._init()},destroy:function(){this.inherited(arguments)},show:function(){this.set("visible",!0)},hide:function(){this.set("visible",!1)},_init:function(){this._visibleWatch();this.set("loaded",!0);this.emit("load",{});this.colorPicker.on("color-change",b.hitch(this,this._colorChange))},_baseClassWatch:function(a,b,c){m.remove(this.domNode,b);m.add(this.domNode,c)},_visibleWatch:function(){this.get("visible")?n.set(this.domNode,"display","block"):
n.set(this.domNode,"display","none")},_colorChange:function(){this.emit("color-change",{color:this.colorPicker.color})},_onClick:function(){if(arguments&&0<arguments.length&&arguments[0].target.className!==this.baseClass){var a=arguments[0].target.className;"color"===a?"none"===n.get(this.colorPicker.domNode,"display")?n.set(this.colorPicker.domNode,"display","block"):n.set(this.colorPicker.domNode,"display","none"):this.emit("click",a)}}})})},"plot/geometry/Marker":function(){define(["dojo/_base/declare",
"../plotUtils","./PlotGeometry"],function(h,e,b){return h([b],{constructor:function(b,a){this.type="point";this.plotType="marker";this.fixPointCount=1;this.setPoints(b)},generate:function(){var b=this.points[0];this.x=b[0];this.y=b[1]}})})},"plot/PlotEdit":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom dojo/Evented ./constants ./plotUtils esri/geometry/Point esri/geometry/Polyline esri/geometry/Polygon esri/graphic esri/Color esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleLineSymbol".split(" "),
function(h,e,b,c,a,d,k,f,g,l,m,n,q){return h([c],{constructor:function(a){if(a){var b=new q(q.STYLE_SOLID,new m("#000000"),1);this.controlPointSymbol=new n(n.STYLE_SQUARE,12,b,new m("#003388"));this._map=a;this._activeControlPointGraphic=this._controlPointGraphics=this._startPoint=this._graphic=null;this._layerMouseOverHandler=e.hitch(this,this._layerMouseOverHandler);this._layerMouseOutHandler=e.hitch(this,this._layerMouseOutHandler);this._layerMouseDownHandler=e.hitch(this,this._layerMouseDownHandler);
this._layerMouseDragHandler=e.hitch(this,this._layerMouseDragHandler);this._layerMouseDragEndHandler=e.hitch(this,this._layerMouseDragEndHandler);this._controlPointLayerMouseDownHandler=e.hitch(this,this._controlPointLayerMouseDownHandler);this._controlPointLayerMouseDragHandler=e.hitch(this,this._controlPointLayerMouseDragHandler);this._controlPointLayerMouseDragEndHandler=e.hitch(this,this._controlPointLayerMouseDragEndHandler)}},activate:function(a){a&&(a.plot&&a!=this._graphic)&&(this.deactivate(),
this._graphic=a,this._initControlPoints(),this._layerMouseOver_Connect=this._graphic.getLayer().on("mouse-over",this._layerMouseOverHandler),this._layerMouseOut_Connect=this._graphic.getLayer().on("mouse-out",this._layerMouseOutHandler))},deactivate:function(){this._graphic&&this.emit("edit-end",{graphic:this._graphic});this._graphic=null;this._clearControlPoints();this._startPoint=this._activeControlPointGraphic=null;this._layerMouseOver_Connect&&this._layerMouseOver_Connect.remove();this._layerMouseOut_Connect&&
this._layerMouseOut_Connect.remove();this._layerMouseDown_Connect&&this._layerMouseDown_Connect.remove();this._layerMouseDrag_Connect&&this._layerMouseDrag_Connect.remove();this._layerMouseDragEnd_Connect&&this._layerMouseDragEnd_Connect.remove();this._controlPointLayerMouseDown_Connect&&this._controlPointLayerMouseDown_Connect.remove();this._controlPointLayerMouseDrag_Connect&&this._controlPointLayerMouseDrag_Connect.remove();this._controlPointLayerMouseDragEnd_Connect&&this._controlPointLayerMouseDragEnd_Connect.remove()},
_initControlPoints:function(){if(this._map){this._controlPointGraphics=[];var a=this._getControlPoints();if(a&&!(0>=a.length)){for(var b=0;b<a.length;b++){var d=new k(a[b][0],a[b][1]);d.spatialReference=this._map.spatialReference;d=new l(d,this.controlPointSymbol);this._controlPointGraphics.push(d);this._map.graphics.add(d)}this._controlPointLayerMouseDown_Connect=this._map.graphics.on("mouse-down",this._controlPointLayerMouseDownHandler)}}},_clearControlPoints:function(){if(this._controlPointGraphics&&
0<this._controlPointGraphics.length){for(var a=0;a<this._controlPointGraphics.length;a++)this._map.graphics.remove(this._controlPointGraphics[a]);this._controlPointGraphics=null}},_controlPointLayerMouseDownHandler:function(a){this._controlPointGraphics&&0<=this._controlPointGraphics.indexOf(a.graphic)&&(this._activeControlPointGraphic=a.graphic,this._map.disablePan(),this._controlPointLayerMouseDrag_Connect=this._map.on("mouse-drag",this._controlPointLayerMouseDragHandler),this._controlPointLayerMouseDragEnd_Connect=
this._map.on("mouse-drag-end",this._controlPointLayerMouseDragEndHandler))},_controlPointLayerMouseDragHandler:function(a){if(this._activeControlPointGraphic){this._activeControlPointGraphic.setGeometry(a.mapPoint);var b=this._controlPointGraphics.indexOf(this._activeControlPointGraphic);this._graphic.plot.updatePoint([a.mapPoint.x,a.mapPoint.y],b);this._graphic.setGeometry(this._graphic.plot.toGeometry())}},_controlPointLayerMouseDragEndHandler:function(a){this._activeControlPointGraphic=null;this._map.enablePan();
this._controlPointLayerMouseDrag_Connect.remove();this._controlPointLayerMouseDragEnd_Connect.remove()},_layerMouseOverHandler:function(a){this._graphic&&this._graphic==a.graphic&&(this._map.setMapCursor("move"),this._layerMouseDown_Connect&&this._layerMouseDown_Connect.remove(),this._layerMouseDown_Connect=this._graphic.getLayer().on("mouse-down",this._layerMouseDownHandler))},_layerMouseOutHandler:function(a){this._map.setMapCursor("default");this._layerMouseDown_Connect&&this._layerMouseDown_Connect.remove()},
_layerMouseDownHandler:function(a){this._startPoint=a.mapPoint;this._map.disablePan();this._layerMouseDrag_Connect=this._map.on("mouse-drag",this._layerMouseDragHandler);this._layerMouseDragEnd_Connect=this._map.on("mouse-drag-end",this._layerMouseDragEndHandler)},_layerMouseDragHandler:function(a){if(!this._activeControlPointGraphic){for(var b=a.mapPoint.x-this._startPoint.x,d=a.mapPoint.y-this._startPoint.y,c=[],f=0;f<this._controlPointGraphics.length;f++){var g=this._controlPointGraphics[f].geometry,
g=[g.x+b,g.y+d];this._startPoint=a.mapPoint;var e=new k(g);e.spatialReference=this._map.spatialReference;this._controlPointGraphics[f].setGeometry(e);c.push(g)}this._graphic.plot.setPoints(c);this._graphic.setGeometry(this._graphic.plot.toGeometry())}},_layerMouseDragEndHandler:function(a){this._map.enablePan();this._layerMouseDown_Connect.remove();this._layerMouseDrag_Connect.remove();this._layerMouseDragEnd_Connect.remove()},_getControlPoints:function(){return!this._graphic?[]:this._graphic.plot.getPoints()}})})},
"plot/geometry/Ellipse":function(){define(["dojo/_base/declare","../constants","../plotUtils","./PlotGeometry"],function(h,e,b,c){return h([c],{constructor:function(a,b){this.type="polygon";this.plotType="ellipse";this.fixPointCount=2;this.setPoints(a)},generate:function(){if(!(2>this.getPointCount())){var a=this.points[0],d=this.points[1],c=b.mid(a,d),f=Math.abs((a[0]-d[0])/2),a=Math.abs((a[1]-d[1])/2);this.rings=this.generatePoints(c,f,a)}},generatePoints:function(a,b,c){for(var f,g,l=[],h=0;h<=
e.FITTING_COUNT;h++)g=2*Math.PI*h/e.FITTING_COUNT,f=a[0]+b*Math.cos(g),g=a[1]+c*Math.sin(g),l.push([f,g]);return l}})})},"plot/geometry/PlotGeometry":function(){define(["dojo/_base/declare","esri/geometry/Point","esri/geometry/Polyline","esri/geometry/Polygon","esri/SpatialReference"],function(h,e,b,c,a){return h(null,{constructor:function(a,b){this.wkid=b||4326},setPoints:function(a){this.points=a?a:[];1<=this.points.length&&this.generate()},getPoints:function(){return this.points.slice(0)},getPointCount:function(){return this.points.length},
updatePoint:function(a,b){0<=b&&b<this.points.length&&(this.points[b]=a,this.generate())},generate:function(){},toGeometry:function(){var d;"point"===this.type?d=new e(this.x,this.y):"polyline"===this.type?d=new b(this.paths):"polygon"===this.type&&(d=new c(this.rings));d.spatialReference=new a(this.wkid);return d},toJson:function(){return{plotType:this.plotType,points:this.points,wkid:this.wkid}}})})},"plot/geometry/AttackArrow":function(){define(["dojo/_base/declare","../constants","../plotUtils",
"./PlotGeometry"],function(h,e,b,c){return h([c],{constructor:function(a,b){this.type="polygon";this.plotType="attackarrow";this.headHeightFactor=0.18;this.headWidthFactor=0.3;this.neckHeightFactor=0.85;this.neckWidthFactor=0.15;this.headTailFactor=0.8;this.setPoints(a)},generate:function(){if(!(2>this.getPointCount()))if(2==this.getPointCount())this.rings=this.points;else{var a=this.getPoints(),c=a[0],e=a[1];b.isClockWise(a[0],a[1],a[2])&&(c=a[1],e=a[0]);var f=[b.mid(c,e)].concat(a.slice(2)),a=this.getArrowHeadPoints(f,
c,e),g=a[0],h=a[4],m=b.distance(c,e)/b.getBaseLength(f),f=this.getArrowBodyPoints(f,g,h,m),m=f.length,c=[c].concat(f.slice(0,m/2));c.push(g);e=[e].concat(f.slice(m/2,m));e.push(h);c=b.getQBSplinePoints(c);e=b.getQBSplinePoints(e);e=c.concat(a,e.reverse());this.rings=e.concat([e[0]])}},getArrowHeadPoints:function(a,c,k){var f=b.getBaseLength(a),g=f*this.headHeightFactor,h=a[a.length-1],f=b.distance(h,a[a.length-2]);c=b.distance(c,k);g>c*this.headTailFactor&&(g=c*this.headTailFactor);k=g*this.headWidthFactor;
c=g*this.neckWidthFactor;g=g>f?f:g;f=g*this.neckHeightFactor;g=b.getThirdPoint(a[a.length-2],h,0,g,!0);f=b.getThirdPoint(a[a.length-2],h,0,f,!0);a=b.getThirdPoint(h,g,e.HALF_PI,k,!1);g=b.getThirdPoint(h,g,e.HALF_PI,k,!0);k=b.getThirdPoint(h,f,e.HALF_PI,c,!1);c=b.getThirdPoint(h,f,e.HALF_PI,c,!0);return[k,a,h,g,c]},getArrowBodyPoints:function(a,c,e,f){var g=b.wholeDistance(a);f*=b.getBaseLength(a);c=b.distance(c,e);c=(f-c)/2;e=0;for(var h=[],m=[],n=1;n<a.length-1;n++){var q=b.getAngleOfThreePoints(a[n-
1],a[n],a[n+1])/2;e+=b.distance(a[n-1],a[n]);var r=(f/2-e/g*c)/Math.sin(q),s=b.getThirdPoint(a[n-1],a[n],Math.PI-q,r,!0),q=b.getThirdPoint(a[n-1],a[n],q,r,!1);h.push(s);m.push(q)}return h.concat(m)}})})},"plot/geometry/Polygon":function(){define(["dojo/_base/declare","../plotUtils","./PlotGeometry"],function(h,e,b){return h([b],{constructor:function(b,a){this.plotType=this.type="polygon";this.setPoints(b)},generate:function(){2>this.getPointCount()||(this.rings=this.points.concat([this.points[0]]))}})})},
"plot/geometry/SquadCombat":function(){define(["dojo/_base/declare","../constants","../plotUtils","./AttackArrow"],function(h,e,b,c){return h([c],{constructor:function(a,b){this.type="polygon";this.plotType="squadcombat";this.headHeightFactor=0.18;this.headWidthFactor=0.3;this.neckHeightFactor=0.85;this.neckWidthFactor=0.15;this.tailWidthFactor=0.1;this.setPoints(a)},generate:function(){var a=this.getPointCount();if(!(2>a)){var c=this.getPoints(),e=this.getTailPoints(c),f=this.getArrowHeadPoints(c,
e[0],e[1]),g=f[0],h=f[4],m=this.getArrowBodyPoints(c,g,h,this.tailWidthFactor),a=m.length,c=[e[0]].concat(m.slice(0,a/2));c.push(g);e=[e[1]].concat(m.slice(a/2,a));e.push(h);c=b.getQBSplinePoints(c);e=b.getQBSplinePoints(e);f=c.concat(f,e.reverse());this.rings=f.concat([f[0]])}},getTailPoints:function(a){var c=b.getBaseLength(a)*this.tailWidthFactor,h=b.getThirdPoint(a[1],a[0],e.HALF_PI,c,!1);a=b.getThirdPoint(a[1],a[0],e.HALF_PI,c,!0);return[h,a]}})})},"plot/geometry/FreehandLine":function(){define(["dojo/_base/declare",
"../plotUtils","./PlotGeometry"],function(h,e,b){return h([b],{constructor:function(b,a){this.type="polyline";this.plotType="freehandline";this.freehand=!0;this.setPoints(b)},generate:function(){2>this.getPointCount()||(this.paths=this.points)}})})},"plot/geometry/Rectangle":function(){define(["dojo/_base/declare","../plotUtils","./PlotGeometry"],function(h,e,b){return h([b],{constructor:function(b,a){this.type="polygon";this.plotType="rectangle";this.fixPointCount=2;this.setPoints(b)},generate:function(){if(!(2>
this.getPointCount())){var b=this.points[0],a=this.points[1],d=Math.min(b[0],a[0]),e=Math.max(b[0],a[0]),f=Math.min(b[1],a[1]),b=Math.max(b[1],a[1]),a=[d,b];this.rings=[a,[e,b],[e,f],[d,f],a]}}})})},"plot/geometry/AssaultDirection":function(){define(["dojo/_base/declare","./FineArrow"],function(h,e){return h([e],{constructor:function(b,c){this.type="polygon";this.plotType="assaultdirection";this.tailWidthFactor=0.2;this.neckWidthFactor=0.25;this.headWidthFactor=0.3;this.headAngle=Math.PI/4;this.neckAngle=
0.17741*Math.PI;this.setPoints(b)}})})},"plot/PlotDraw":function(){define("dojo/_base/declare dojo/_base/lang dojo/Evented ./constants ./plotUtils esri/graphic esri/Color esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol ./geometry/Arc ./geometry/AssaultDirection ./geometry/AttackArrow ./geometry/Circle ./geometry/ClosedCurve ./geometry/Curve ./geometry/DoubleArrow ./geometry/Ellipse ./geometry/FineArrow ./geometry/FreehandLine ./geometry/FreehandPolygon ./geometry/GatheringPlace ./geometry/Lune ./geometry/Marker ./geometry/Polygon ./geometry/Polyline ./geometry/Rectangle ./geometry/Sector ./geometry/SquadCombat ./geometry/StraightArrow ./geometry/TailedAttackArrow ./geometry/TailedSquadCombat".split(" "),
function(h,e,b,c,a,d,k,f,g,l,m,n,q,r,s,u,v,w,x,z,A,B,C,D,E,F,G,H,I,J,K,L){var p=h([b],{constructor:function(a){this.markerSymbol=new f(f.STYLE_SQUARE,8,null,new k("#000000"));this.lineSymbol=new g(g.STYLE_SOLID,new k("#000000"),2);this.fillSymbol=new l(l.STYLE_SOLID,this.lineSymbol,new k([0,0,0,0.25]));this._firstClickHandler=e.hitch(this,this._firstClickHandler);this._nextClickHandler=e.hitch(this,this._nextClickHandler);this._doubleClickHandler=e.hitch(this,this._doubleClickHandler);this._mouseMoveHandler=
e.hitch(this,this._mouseMoveHandler);this._plotParams=this._plotType=this._graphic=this._plot=this._points=null;this._map=a},activate:function(a,b){this.deactivate();this._map.disableDoubleClickZoom();this._firstClick_Connect=this._map.on("click",this._firstClickHandler);this._plotType=a;this._plotParams=b},deactivate:function(){this._firstClick_Connect&&this._firstClick_Connect.remove();this._nextClick_Connect&&this._nextClick_Connect.remove();this._doubleClick_Connect&&this._doubleClick_Connect.remove();
this._mouseMove_Connect&&this._mouseMove_Connect.remove();this._map.enableDoubleClickZoom();this._map.graphics.remove(this._graphic);this._points=[];this._plotParams=this._plotType=this._graphic=this._plot=null},isDrawing:null!=this._plotType,_firstClickHandler:function(a){this._firstClick_Connect.remove();this._points.push([a.mapPoint.x,a.mapPoint.y]);this._plot=p.createPlot(this._plotType,this._points,this._map.spatialReference.wkid);this._graphic=new d;this._graphic.setSymbol(this._generateSymbol(this._plot));
this._map.graphics.add(this._graphic);this._plot.fixPointCount==this._plot.getPointCount()?this._doubleClickHandler(a):(this._nextClick_Connect=this._map.on("click",this._nextClickHandler),this._plot.freehand||(this._doubleClick_Connect=this._map.on("dbl-click",this._doubleClickHandler)),this._mouseMove_Connect=this._map.on("mouse-move",this._mouseMoveHandler))},_nextClickHandler:function(b){if(this._plot.freehand||!(a.distance([b.mapPoint.x,b.mapPoint.y],this._points[this._points.length-1])<c.ZERO_TOLERANCE))this._points.push([b.mapPoint.x,
b.mapPoint.y]),this._plot.setPoints(this._points),this._plot.fixPointCount==this._plot.getPointCount()?this._doubleClickHandler(b):(this._plot&&this._plot.freehand&&this._doubleClickHandler(b),this._graphic.setGeometry(this._plot.toGeometry()))},_doubleClickHandler:function(a){this.emit("draw-end",{geometry:this._plot.toGeometry(),plot:this._plot});this.deactivate()},_mouseMoveHandler:function(b){a.distance([b.mapPoint.x,b.mapPoint.y],this._points[this._points.length-1])<c.ZERO_TOLERANCE||(this._plot.freehand?
(this._points.push([b.mapPoint.x,b.mapPoint.y]),this._plot.setPoints(this._points)):(b=this._points.concat([[b.mapPoint.x,b.mapPoint.y]]),this._plot.setPoints(b)),this._graphic.setGeometry(this._plot.toGeometry()))},_generateSymbol:function(a){var b;"point"===a.type?b=this.markerSymbol:"polyline"===a.type?b=this.lineSymbol:"polygon"===a.type&&(b=this.fillSymbol);return b}});p.createPlot=function(a,b,c){switch(a){case p.ARC:return new m(b,c);case p.ELLIPSE:return new w(b,c);case p.CURVE:return new u(b,
c);case p.CLOSED_CURVE:return new s(b,c);case p.LUNE:return new C(b,c);case p.SECTOR:return new H(b,c);case p.GATHERING_PLACE:return new B(b,c);case p.STRAIGHT_ARROW:return new J(b,c);case p.ASSAULT_DIRECTION:return new n(b,c);case p.ATTACK_ARROW:return new q(b,c);case p.FINE_ARROW:return new x(b,c);case p.CIRCLE:return new r(b,c);case p.DOUBLE_ARROW:return new v(b,c);case p.TAILED_ATTACK_ARROW:return new K(b,c);case p.SQUAD_COMBAT:return new I(b,c);case p.TAILED_SQUAD_COMBAT:return new L(b,c);case p.FREEHAND_LINE:return new z(b,
c);case p.FREEHAND_POLYGON:return new A(b,c);case p.POLYGON:return new E(b,c);case p.MARKER:return new D(b,c);case p.RECTANGLE:return new G(b,c);case p.POLYLINE:return new F(b,c)}};e.mixin(p,{ARC:"arc",ELLIPSE:"ellipse",CURVE:"curve",CLOSED_CURVE:"closedcurve",LUNE:"lune",SECTOR:"sector",GATHERING_PLACE:"gatheringplace",STRAIGHT_ARROW:"straightarrow",ASSAULT_DIRECTION:"assaultdirection",ATTACK_ARROW:"attackarrow",TAILED_ATTACK_ARROW:"tailedattackarrow",SQUAD_COMBAT:"squadcombat",TAILED_SQUAD_COMBAT:"tailedsquadcombat",
FINE_ARROW:"finearrow",CIRCLE:"circle",DOUBLE_ARROW:"doublearrow",POLYLINE:"polyline",FREEHAND_LINE:"freehandline",POLYGON:"polygon",FREEHAND_POLYGON:"freehandpolygon",RECTANGLE:"rectangle",MARKER:"marker",TRIANGLE:"triangle"});return p})},"plot/plotDecoder":function(){define(["./PlotDraw","esri/graphic","esri/symbols/jsonUtils"],function(h,e,b){return{fromJson:function(c){if(c&&c.plot&&c.symbol){var a=h.createPlot(c.plot.plotType,c.plot.points,c.plot.wkid);c=b.fromJson(c.symbol);if(a&&c)return c=
new e(a.toGeometry(),c),c.plot=a,c}}}})},"plot/geometry/TailedSquadCombat":function(){define(["dojo/_base/declare","../constants","../plotUtils","./AttackArrow"],function(h,e,b,c){return h([c],{constructor:function(a,b){this.type="polygon";this.plotType="tailedsquadcombat";this.headHeightFactor=0.18;this.headWidthFactor=0.3;this.neckHeightFactor=0.85;this.neckWidthFactor=0.15;this.tailWidthFactor=0.1;this.swallowTailFactor=1;this.swallowTailPnt=null;this.setPoints(a)},generate:function(){var a=this.getPointCount();
if(!(2>a)){var c=this.getPoints(),e=this.getTailPoints(c),f=this.getArrowHeadPoints(c,e[0],e[2]),g=f[0],h=f[4],m=this.getArrowBodyPoints(c,g,h,this.tailWidthFactor),a=m.length,c=[e[0]].concat(m.slice(0,a/2));c.push(g);g=[e[2]].concat(m.slice(a/2,a));g.push(h);c=b.getQBSplinePoints(c);g=b.getQBSplinePoints(g);this.rings=c.concat(f,g.reverse(),[e[1],c[0]])}},getTailPoints:function(a){var c=b.getBaseLength(a)*this.tailWidthFactor,h=b.getThirdPoint(a[1],a[0],e.HALF_PI,c,!1),f=b.getThirdPoint(a[1],a[0],
e.HALF_PI,c,!0);a=b.getThirdPoint(a[1],a[0],0,c*this.swallowTailFactor,!0);return[h,a,f]}})})}}});define("plot/plot",[],1);
//# sourceMappingURL=plot.js.map